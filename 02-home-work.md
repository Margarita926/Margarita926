# Модуль 2 · Практичне завдання 1  
## Теоретична підготовка

## 1. Огляд архітектури та точки інтеграції
- External System → Controller
- Controller(Validate Format & auth)
- Controller → External System(responce 200)
- Controller → RMQ Producer→ RabbitMQ → RMQ Consumer
- EndUserAppSender ↔ Account DB(Lookup client config)
- EndUserAppSender → Client Deployment → EndUserAppSender

Критичні інтеграційні точки і ризики:
- HTTP API endpoints (latency, request size)
- Message queue (RabbitMQ) — backlog, delivery latency
- Database — slow queries, connection pool exhaustion
- External APIs — slow or failing dependencies

## 2. Бізнес-вимоги та Performance SLO
очікування щодо роботи сервісу з точки зору бізнесу та користувача
критичні нефункціональні вимоги, що впливають на продуктивність

### 2.1 Бізнес-вимоги
- данні повинні відображатись в ріал-таймі
- конверсії не повиині губитись
- не повинні створюватись дублі на повторні виплати
- система має переживати піки трафіку
- при падінні інтеграції повинен бути retry та події мають бути доставлені пізніше
  
### 2.2 Набір SLO

| Метрика          | Значення                              |Обґрунтування
| ---------------- | ------------------------------------- |-------------------------
| Latency          | < 500 ms                              |час обробки webhook(орієнтир UX реального часу) це критично важливо, якщо> кількох секунд то починається retry
| Availability     | 99.9% uptime                          |на скільки сервіс доступний, втрати подій = втрата грошей
| Throughput       | min 500 events/sec;max 2000 events/sec|скільки подій/сек (без деградації latency)при піку трафіку події стають у чергу на 20 хвилин.Орієнтир- пікове навантаження ×3                    
| Error Rate       | 0.1%(не валідації)                    |% 5хх помилок,може привести до скритої втрати даних,  неконсистентні дані      
| Delivery Success | 99.99% (через retry)                  |% доставлених подій,робота над надійністю
| Time to Recover  | 2-5 хв                                |як швидко відновлюється після падіння,чим довше відновлення→ тим більша втрата данних
| Freshness        | ≤ 15 сек                              |як швидко дані з’являються в системі, UX досвід
       


## 3. Сценарій взаємодії з командою
Марго- лідер тестування(стратегія, комунікація)
Ігор- інженер середовища(шарить в інфраструктурі)
Марго- розробка сценаріїв(налаштування інструментів і розробка сценаріїв)
Ніл- робудова моніторінгу в графані
Марго- QA інженер

Я почну не з метрик, а з ризикованості подій бо webhook сервіси ламаються не через навантаження, а від неправильних очікувань (формування причинно- наслідкових звязків у бізнеса що перформенс це важливо)
якщо webhook приходить за 20 секунд -3d paty робить retry -> з’являються дублікати -> неправильні виплати-> втрата грошей

**потрібно дізнатися в бізнеса:**
(В результаті з’являється класифікація подій Critical,Important,Optional)
- які події критичні (платежі, purchase, payout, логін)
- які події інформаційні (notification, status update)
- які типи подій є критичними для клієнтів
- чи допустима затримка, дублікати, втрата

Після цього узгоджуємо: SLO (що гарантуємо) SLI (що реально міряємо) SLA (який еталон)

**Розробникам:**
- які події ідемпотентні
- як реалізована обробка веб‑хуків (синхронно чи асинхронно)
- webhook sync чи через чергу
- як логуються помилки та таймаути
- є механізми ретраїв, дедуплікації та чергування

**DevOps**
- чи є rate limit
- autoscaling 
- чи є dead letter queue
- як виглядає деградація  throttling чи падіння
- чи синхронне логування

**Продакт**

- що гірше: затримка чи дублікати
- чи можна відправляти пізніше але гарантовано
- як швидко очікуємо подію
- які є піки (розсилки, імпорт, cron, маркетинг)
- чи є пріоритетні інтеграції, які потребують особливої уваги

**Як узгоджую сценарії навантаження** моделюємо поведінку
Узгодити пріоритетність запуску сценаріїв:спочатку критичні бізнес‑кейси, потім експериментальні

- Stress Testing: перевірка межі системи при 150–200% навантаження
- Load Testing: нормальне навантаження + поступове збільшення
- Spike Testing: різкі піки активності масові одночасні виклики
- Soak Testing: довготривале навантаження для виявлення memory leaks
- Breakpoint Testing: визначення точки відмови системи та час відновлення після падіння


**ескалюю проблеми**
фіксую метрику->показую бізнес impact-> пропоную варіанти вирішення(accept, mitigate,block release)
- проблема інфраструктурна - звертаюсь до DevOps
- відхилення від SLO - пінгую розробників
- вплив критичний для бізнесу- повідомлення бізнесу

**Робота з інцидентами**
вимкнути ретраї-> перевірити queue lag-> визначити: втрата чи затримка -> увімкнути buffering / replay
- по-перше встановити канал комунікації Slack наприклад
- та про збір і брейн шторм, мобілізацію у випадку інцедентів
- документувати всі знайдені проблеми та час відновлення після навантаження


## 4. Висновки
Webhook-сервіс повинен гарантувати доставку фінансово значимих подій без втрати даних, забезпечувати їх відображення в майже в реальному часі та витримувати 
пікові навантаження. Основними нефункціональними вимогами є надійність, ідемпотентність, масштабованість та спостережуваність. 
QA формує гіпотези ризиків, визначає критерії перевірки та ініціює роботу інфраструктури й моніторингу. 
Відповідальний по середовищу забезпечує керованість системи, відповідальний по моніторингу спостережуваність, після чого QA валідовує реальну поведінку сервісу. Таким чином 
команда працює від перевірюваних властивостей системи.
